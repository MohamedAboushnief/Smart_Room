 /**********************************************************************************************************************
 *  File		: Eeprom.c
 *	Module		: EEPROM
 *	Target		: ATMEGA32
 *	Author		: mAboushenif
 *  Description	: Functions for using the EEPROM module
 *
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  INCLUDES
 *********************************************************************************************************************/
#include "Eeprom.h"
/**********************************************************************************************************************
*  LOCAL MACROS CONSTANT\FUNCTION
*********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL DATA
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  GLOBAL DATA
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTION PROTOTYPES
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTIONS
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  GLOBAL FUNCTIONS
 *********************************************************************************************************************/


/******************************************************************************
* \Syntax          : void EEPROM_Write(u16 address, u8 data)
* \Description     : Write in EEPROM
* \Sync\Async      : Synchronous
* \Reentrancy      : Non Reentrant
* \Parameters (in) : address data
* \Return value:   : None
*******************************************************************************/

void EEPROM_Write(u16 address, u8 data){

	/* Wait for completion of previous write */
	while(CHECK_BIT(EEPROM_CONTROL_REG,EEWE))
	;
	/* Set up address and data registers */
	EEPROM_ADDRESS_REG_L = address;
	EEPROM_ADDRESS_REG_H = address>>8;

	EEPROM_DATA_REG = data;
	/* Write logical one to EEMWE */
	SET_BIT(EEPROM_CONTROL_REG,EEMWE);
	/* Start eeprom write by setting EEWE */
	SET_BIT(EEPROM_CONTROL_REG,EEWE);

}

/******************************************************************************
* \Syntax          : u8 EEPROM_Read(u16 address)
* \Description     : Read from EEPROM
* \Sync\Async      : Synchronous
* \Reentrancy      : Non Reentrant
* \Parameters (in) : address
* \Return value:   : None
*******************************************************************************/
u8 EEPROM_Read(u16 address){
	/* Wait for completion of previous write */
	while(CHECK_BIT(EEPROM_CONTROL_REG,EEWE))
		;
	/* Set up address register */
	EEPROM_ADDRESS_REG_L = address;
	EEPROM_ADDRESS_REG_H = address>>8;
	/* Start eeprom read by writing EERE */
	SET_BIT(EEPROM_CONTROL_REG,EERE);
	/* Return data from data register */
	return EEPROM_DATA_REG;

}


/**********************************************************************************************************************
 *  END OF FILE: Eeprom.c
 *********************************************************************************************************************/
